@prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
@prefix hm: <http://vocab.cosmicdynamo.net/hypermedia.owl#> .
@prefix doc: <http://vocab.cosmicdynamo.net/documentation.owl#> .

@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

@base <http://vocab.cosmicdynamo.net/collection.owl> .

<> a owl:Ontology ;
   rdfs:label "Collection Ontology" ; 
   rdfs:comment "Controls for interacting with collections of data"@en ;
    owl:versionInfo "draft"^^xsd:string ;
    dc:dateSubmitted "2014-12-06"^^xsd:date ;
    dc:creator <mailto:bpease@cosmicdynamo.net> ;
    dc:publisher <http://cosmicdynamo.net> ;
    <http://purl.org/vocab/vann/preferredNamespacePrefix> "col"  ;
    <http://purl.org/vocab/vann/preferredNamespaceUri> "http://vocab.cosmicdynamo.net/collection.owl#" .

#################################################################
#
#    Data properties
#
#################################################################

###  http://vocab.cosmicdynamo.net/collection.owl#itemsPerPage
:itemsPerPage a owl:DatatypeProperty ;
              rdfs:label "Max Page Size" ;
              rdfs:comment "Specifies how many items should be on any given page of a pagable resource" ;
			        rdfs:domain :Page ;
              rdfs:range xsd:nonNegativeInteger ;
              doc:example """
                @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
                @prefix ex: <http://vocab.example.com/example.owl#> .
                @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
                @prefix owl: <http://www.w3.org/2002/07/owl#> .

                @base <http://example.com/Object/> .

                # In this example ex:hasItems has a total of 10 items
                ## because the start index is 7 only three items are remaining from this point in
                ## the collection, so itemsPerPage is still 5 but the count is only 3 to match the
                ## number on this specific page
                <> a owl:Thing ;
                   ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

                <Items?o=7> a :Container, :Page ;
                            :membershipSubject <> ;
                            :membershipPredicate ex:hasItems ;
                            :isPartOf <Items/> ;
                            :itemsPerPage "5"^^xsd:nonNegativeInteger  ;
                            :startIndex "7"^^xsd:nonNegativeInteger  ;
                            :totalCount "10"^^xsd:nonNegativeInteger .
              """ .

###  http://vocab.cosmicdynamo.net/collection.owl#startIndex
:startIndex a owl:DatatypeProperty ;
            rdfs:label "Page Starting Index" ;
            rdfs:comment "Specifies the index of the total Collection at which this page appears" ;
			      rdfs:domain :Page ;
			      rdfs:range xsd:nonNegativeInteger ;
            doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              # In this example it should be noted that there are actually 10 items in the
              ## <> ex:hasItems collection.  Because the result is paged we only provided the client
              ## with items at indexes 3, 4, and 5 of the total list from 0-9
              <> a owl:Thing ;
                 ex:hasItems ( <Items/4> <Items/5> <Items/6> ) .

              <Items?p=2> a :Container, :Page ;
                          :membershipSubject <> ;
                          :membershipPredicate ex:hasItems ;
                          :isPartOf <Items/> ;
                          :itemsPerPage "3"^^xsd:nonNegativeInteger  ;
                          :startIndex "3"^^xsd:nonNegativeInteger  ;
                          :totalCount "10"^^xsd:nonNegativeInteger .
            """ .

###  http://vocab.cosmicdynamo.net/collection.owl#totalResults
:totalCount a owl:DatatypeProperty ;
            rdfs:label "Collection Total Results" ;
            rdfs:domain :Container ;
            rdfs:range xsd:unsignedInt ;
            doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              <> a owl:Thing ;
                 ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

              <Items/> a :Container ;
                       :membershipSubject <> ;
                       :membershipPredicate ex:hasItems ;
                       :totalCount "3"^^xsd:nonNegativeInteger .
            """ .

###  http://vocab.cosmicdynamo.net/collection.owl#searchTerms
:fuzzyText a owl:DatatypeProperty ;
           rdfs:label "Fuzzy Text-Search Value" ;
           rdfs:comment "A generic string search term for performing fuzzy search operations" ;
           rdfs:domain :SearchResult ;
           rdfs:range xsd:string ;
           doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              # For this example ex:hasItems has 10 total avalable but only three match the
              ## fuzzy search value of 'fil'.  The results are ordered according to a server-side
              ## relavence algorithm
              <> a owl:Thing ;
                 ex:hasItems ( <Items/3> <Items/1> <Items/7> ) .

              <Items/> a :Container, :SearchResult ;
                       :membershipSubject <> ;
                       :membershipPredicate ex:hasItems ;
                       :totalCount "3"^^xsd:nonNegativeInteger ;
                       :fuzzyText "fil"^^xsd:string .
            """ .

#################################################################
#
#    Object properties
#
#################################################################
:membershipSubject a owl:ObjectProperty ;
                   rdfs:label "Container Member Subject" ;
                   rdfs:comment "Link pointing to the parent object to which this container is attached" ;
                   rdfs:domain :Container ;
                   rdfs:rage owl:Thing ;
                   doc:example """
                      @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
                      @prefix ex: <http://vocab.example.com/example.owl#> .
                      @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
                      @prefix owl: <http://www.w3.org/2002/07/owl#> .

                      @base <http://example.com/Object/> .

                      <> a owl:Thing ;
                         ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

                      <Items/> a :Container ;
                               :membershipSubject <> ;
                               :membershipPredicate ex:hasItems ;
                               :totalCount "3"^^xsd:nonNegativeInteger .
                   """ .

:membershipPredicate a owl:ObjectProperty ;
                     rdfs:label "Container Member predicate" ;
                     rdfs:comment "Link pointing to the predicate off to which this collection belongs" ;
                     rdfs:domain :Container ;
                     rdfs:range rdf:Property ;
                     doc:example """
                        @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
                        @prefix ex: <http://vocab.example.com/example.owl#> .
                        @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
                        @prefix owl: <http://www.w3.org/2002/07/owl#> .

                        @base <http://example.com/Object/> .

                        <> a owl:Thing ;
                           ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

                        <Items/> a :Container ;
                                 :membershipSubject <> ;
                                 :membershipPredicate ex:hasItems ;
                                 :totalCount "3"^^xsd:nonNegativeInteger .
                     """ .

:isPartOf a owl:ObjectProperty ;
          rdfs:label "Modified Container's Data Source" ;
          rdfs:comment "Predicate Linking back to the un-modified container of which the parent is a sub-set" ;
          rdfs:domain :ModifiedContainer ;
          rdfs:range :Container ;
          doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              <> a owl:Thing ;
                 ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

              <Items?name=someValue> a :ModifiedContainer ;
                                       :membershipSubject <> ;
                                       :membershipPredicate ex:hasItems ;
                                       :isPartOf <Items/> ;
                                       :totalCount "3"^^xsd:nonNegativeInteger .
          """ .
#################################################################
#
#    Classes
#
#################################################################

###  http://vocab.cosmicdynamo.net/collection.owl#Container
:Container a owl:Class ;
           rdfs:label "Container" ;
           rdfs:comment "The container providing information on a collection of data attached to a parent resource" ;
           rdfs:subClassOf [
              a owl:Restriction ;
              owl:minCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :totalCount
           ] , [
              a owl:Restriction ;
              owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :totalCount
           ] , [
              a owl:Restriction ;
              owl:minCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :membershipSubject
           ] , [
              a owl:Restriction ;
              owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :membershipSubject
           ] , [
              a owl:Restriction ;
              owl:minCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :membershipPredicate
           ] , [
              a owl:Restriction ;
              owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
              owl:onProperty :membershipPredicate
           ] ;
           doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              <> a owl:Thing ;
                 ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

              <Items/> a :Container ;
                       :membershipSubject <> ;
                       :membershipPredicate ex:hasItems ;
                       :totalCount "3"^^xsd:nonNegativeInteger .
           """ .

:ModifiedContainer a owl:Class ;
                   rdfs:label "Modified Container" ;
                   rdfs:comment "Parent Class for containers which represent a sub-set or otherwise altered view of another container" ;
                   rdfs:subClassOf :Container , [
                      a owl:Restriction ;
                      owl:minCardinality "1"^^xsd:nonNegativeInteger ;
                      owl:onProperty :isPartOf
                   ] , [
                      a owl:Restriction ;
                      owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
                      owl:onProperty :isPartOf
                   ] ;
                   doc:example """
                      @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
                      @prefix ex: <http://vocab.example.com/example.owl#> .
                      @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
                      @prefix owl: <http://www.w3.org/2002/07/owl#> .

                      @base <http://example.com/Object/> .

                      <> a owl:Thing ;
                         ex:hasItems ( <Items/1> ) .

                      <Items/?some=query> a :ModifiedContainer ;
                                         :membershipSubject <> ;
                                         :membershipPredicate ex:hasItems ;
                                         :isPartOf <Items/> ;
                                         :totalCount "3"^^xsd:nonNegativeInteger .
                   """ .

###  http://vocab.cosmicdynamo.net/collection.owl#Pageable
:Pageable a owl:Class ;
          rdfs:label "Pageable Container" ;
          rdfs:comment "A collection of data that is broken into multiple pages" ;
          rdfs:subClassOf :ModifiedContainer ;
          doc:example """
            @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
            @prefix hm: <http://vocab.cosmicdynamo.net/hypermedia.owl#> .
            @prefix ex: <http://vocab.example.com/example.owl#> .
            @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
            @prefix owl: <http://www.w3.org/2002/07/owl#> .

            @base <http://example.com/Object/> .

            <> a owl:Thing ;
               ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

            <Items/> a :Container, :Pageable ;
                     :membershipSubject <> ;
                     :membershipPredicate ex:hasItems ;
                     hm:hasLink [
                          a hm:TemplateLink , :PageLink ;
                          hm:hasTemplateUrl "http://example.com/Items?startIndex={startIndex}&pageSize={itemsPerPage}" ;
                          hm:hasTemplateItem [
                              a hm:TemplateItem ;
                              hm:templateItemPredicate :startIndex ;
                              hm:token "{startIndex}"
                          ] , [
                              a hm:TemplateItem ;
                              hm:templateItemPredicate :itemsPerPage ;
                              hm:token "{itemsPerPage}"
                          ]
                     ] .
          """ .

###  http://vocab.cosmicdynamo.net/collection.owl#SearchableContainer
:Searchable a owl:Class ;
            rdfs:label "Searchable Container" ;
            rdfs:comment "A container that allows a client to Search for a subset of it's contained values" ;
            rdfs:subClassOf :Container , [
              a owl:Restriction ;
              owl:minCardinality "0"^^xsd:nonNegativeInteger ;
              owl:onProperty :fuzzyText
            ] ;
            doc:example """
              @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
              @prefix hm: <http://vocab.cosmicdynamo.net/hypermedia.owl#> .
              @prefix ex: <http://vocab.example.com/example.owl#> .
              @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
              @prefix owl: <http://www.w3.org/2002/07/owl#> .

              @base <http://example.com/Object/> .

              # To be a searchable container it MUST expose a Search link with details on how the
              ## client goes about searching on this Container
              <Items/> a :Container, :Searchable ;
                       :membershipSubject <> ;
                       :membershipPredicate ex:hasItems ;
                       :totalCount "10"^^xsd:nonNegativeInteger ;
                       hm:hasLink [
                          a hm:TemplateLink , :Search ;
                          hm:hasTemplateUrl "http://example.com/Items?q={value?}" ;
                          hm:hasTemplateItem [
                              a hm:TemplateItem ;
                              hm:templateItemPredicate :fuzzyText ;
                              hm:token "{value?}"
                          ]
                       ] .
            """ .

###  http://vocab.cosmicdynamo.net/collection.owl#SearchResult
:SearchResult a owl:Class ;
              rdfs:label "Search Result Container" ;
              rdfs:comment "A collection of data containing only those results which passed a set of search criteria" ;
              rdfs:subClassOf :ModifiedContainer ;
              doc:example """
                @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
                @prefix ex: <http://vocab.example.com/example.owl#> .
                @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
                @prefix owl: <http://www.w3.org/2002/07/owl#> .

                @base <http://example.com/Object/> .

                <> a owl:Thing ;
                   ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .

                # A search result MAY contain a Search Link for refining/altering the search.
                # A search result MAY be pageable.
                # A search rusult MAY NOT be :Searchable
                <Items?q=someValue> a :Container , :SearchResult ;
                                    :membershipSubject <> ;
                                    :isPartOf <Items/> ;
                                    :membershipPredicate ex:hasItems ;
                                    :totalCount "3"^^xsd:nonNegativeInteger .
              """ .

###  http://vocab.cosmicdynamo.net/collection.owl#SearchResult
:Page a owl:Class ;
      rdfs:label "Page" ;
      rdfs:comment "Represents a subset of a Container; MUST NOT be :Searchable" ;
      rdfs:subClassOf :ModifiedContainer , [
          a owl:Restriction ;
          owl:minCardinality "1"^^xsd:nonNegativeInteger ;
          owl:onProperty :itemsPerPage
      ] , [
          a owl:Restriction ;
          owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
          owl:onProperty :itemsPerPage
      ] , [
          a owl:Restriction ;
          owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
          owl:onProperty :startIndex
      ] , [
          a owl:Restriction ;
          owl:maxCardinality "1"^^xsd:nonNegativeInteger ;
          owl:onProperty :startIndex
      ] ;
      doc:example """
        @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
        @prefix ex: <http://vocab.example.com/example.owl#> .
        @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
        @prefix owl: <http://www.w3.org/2002/07/owl#> .

        @base <http://example.com/Object/> .

        <> a owl:Thing ;
           ex:hasItems ( <Items/1> <Items/2> <Items/3> ) .
           
        <Items?q=someValue> a :Container , :Page ;
                            :membershipSubject <> ;
                            :membershipPredicate ex:hasItems ;
                            :isPartOf <Items/> ;
                            :itemsPerPage "3"^^xsd:nonNegativeInteger  ;
                            :startIndex "0"^^xsd:nonNegativeInteger  ;
                            :totalCount "10"^^xsd:nonNegativeInteger .
      """ .

###  http://vocab.cosmicdynamo.net/collection.owl#Search
:Search a owl:Class ;
        rdfs:label "Search Link"@en ;
        rdfs:comment "A Link definition providing instructions on how to perform a search on the Instances contained in the parent Container"@en ;
        rdfs:subClassOf hm:TemplateLink ;
        doc:example """
          @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
          @prefix hm: <http://vocab.cosmicdynamo.net/hypermedia.owl#> .
          @prefix ex: <http://vocab.example.com/example.owl#> .
          @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
          @prefix owl: <http://www.w3.org/2002/07/owl#> .

          @base <http://example.com/Object/> .

          # To be a searchable container it MUST expose a Search link with details on how the
          ## client goes about searching on this Container
          <Items/> a :Container, :Searchable ;
                   :membershipSubject <> ;
                   :membershipPredicate ex:hasItems ;
                   :totalCount "10"^^xsd:nonNegativeInteger ;
                   hm:hasLink [
                        a hm:TemplateLink , :Search ;
                        hm:hasTemplateUrl "http://example.com/Items?q={value?}" ;
                        hm:hasTemplateItem [
                            a hm:TemplateItem ;
                            hm:templateItemPredicate :fuzzyText ;
                            hm:token "{value?}"
                        ]
                   ] .
        """ .

:PageLink a owl:Class ;
        rdfs:label "Pageination Link"@en ;
        rdfs:comment "A Link definition providing instructions on how to page through data contained in the parent Container"@en ;
        rdfs:subClassOf hm:TemplateLink ;
        doc:example """
          @prefix : <http://vocab.cosmicdynamo.net/collection.owl#> .
          @prefix hm: <http://vocab.cosmicdynamo.net/hypermedia.owl#> .
          @prefix ex: <http://vocab.example.com/example.owl#> .
          @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
          @prefix owl: <http://www.w3.org/2002/07/owl#> .

          @base <http://example.com/Object/> .

          # To be a Pageable container it MUST expose a PageLink with details on how the client goes about paging this Container
          <Items/> a :Container, :Pageable ;
                   :membershipSubject <> ;
                   :membershipPredicate ex:hasItems ;
                   :totalCount "10"^^xsd:nonNegativeInteger ;
                   hm:hasLink [
                        a hm:TemplateLink , :PageLink ;
                        hm:hasTemplateUrl "http://example.com/Items?startIndex={startIndex}&pageSize={itemsPerPage}" ;
                        hm:hasTemplateItem [
                            a hm:TemplateItem ;
                            hm:templateItemPredicate :startIndex ;
                            hm:token "{startIndex}"
                        ] , [
                            a hm:TemplateItem ;
                            hm:templateItemPredicate :itemsPerPage ;
                            hm:token "{itemsPerPage}"
                        ]
                   ] .
        """ .